/* static/css/styles.css */

/* --- Consolidated Professional Styles --- */
:root {
    /* Light Theme (Default) - Neon Blue/White */
    --primary: #00FFFF;         /* Bright Neon Blue */
    --secondary: #7DFDFE;       /* Lighter Neon Blue/Cyan */
    --accent: #FF00FF;          /* Vibrant Pink */
    --success: #39FF14;          /* Neon Lime Green */
    --danger: #FF1D15;           /* Neon Red (similar to dark mode primary for consistency) */
    --warning: #FFF01F;          /* Neon Yellow */
    --light: #E0E0E0;           /* Very Light Gray (almost white) */
    --dark: #1A1A1A;            /* Dark Gray for text */
    --gray: #888888;            /* Medium Gray */
    --white: #FFFFFF;

    /* UI Elements - Light */
    --bg-body: var(--white);         /* White Background */
    --bg-card: var(--white);
    --bg-header: var(--white);
    --bg-hover: rgba(0, 255, 255, 0.1); /* Light Neon Blue hover */

    /* Text - Light */
    --text-main: var(--dark);       /* Dark Text for contrast */
    --text-muted: var(--gray);
    --text-heading: var(--primary);
    --text-on-primary: var(--dark); /* Dark text on neon blue */
    --text-on-dark: #F5F5F5;    /* Light text on dark backgrounds */
    --text-link: var(--primary);
    --text-link-hover: var(--secondary);

    /* Borders - Light */
    --border-color: #C0C0C0; /* Lighter gray border */
    --border-card: rgba(0, 255, 255, 0.3); /* Neon blue border */
    --border-header: rgba(0, 255, 255, 0.2); /* Lighter neon blue border */

    /* Shadows - Light (subtle neon glow) */
    --shadow-card: 0 2px 8px rgba(0, 255, 255, 0.2);
    --shadow-card-hover: 0 4px 12px rgba(0, 255, 255, 0.3);

    /* Specific Elements */
    --ticker-bg: var(--dark);       /* Dark background for ticker */
    --ticker-text: var(--white);    /* White text for ticker */
    --ticker-change-positive: var(--success); /* Neon Green */
    --ticker-change-negative: var(--danger);  /* Neon Red */

    /* Action Badges - Light Theme (Neon) */
    --action-badge-buy-bg: rgba(57, 255, 20, 0.15); /* Neon Green bg */
    --action-badge-buy-text: var(--success);
    --action-badge-strong-buy-bg: rgba(57, 255, 20, 0.25);
    --action-badge-strong-buy-text: var(--success);
    --action-badge-sell-bg: rgba(255, 29, 21, 0.15); /* Neon Red bg */
    --action-badge-sell-text: var(--danger);
    --action-badge-strong-sell-bg: rgba(255, 29, 21, 0.25);
    --action-badge-strong-sell-text: var(--danger);
    --action-badge-none-bg: rgba(136, 136, 136, 0.2); /* Gray bg */
    --action-badge-none-text: var(--gray);

    /* News Item Sentiment - Light Theme (Neon) */
    --news-item-sentiment-positive-bg: rgba(57, 255, 20, 0.15);
    --news-item-sentiment-positive-text: var(--success);
    --news-item-sentiment-negative-bg: rgba(255, 29, 21, 0.15);
    --news-item-sentiment-negative-text: var(--danger);
    --news-item-sentiment-neutral-bg: rgba(136, 136, 136, 0.2);
    --news-item-sentiment-neutral-text: var(--gray);

    /* Price Change Indicators - Light Theme (Neon) */
    --price-change-positive-bg: rgba(57, 255, 20, 0.2);
    --price-change-positive-text: #00A300; /* Darker Neon Green text */
    --price-change-negative-bg: rgba(255, 29, 21, 0.2);
    --price-change-negative-text: #D40000; /* Darker Neon Red text */

    --theme-toggle-hover-bg: rgba(0, 255, 255, 0.15); /* Neon Blue hover for toggle */
}

/* --- Enhanced Dark Theme Variables - Neon Red/Black --- */
[data-theme="dark"] {
    /* Base Colors - Dark Neon */
    --primary: #FF0000;          /* Bright Neon Red */
    --secondary: #FF4500;        /* Lighter Neon Red/Orange */
    --accent: #FFFF00;           /* Neon Yellow */
    --success: #00FF00;           /* Neon Green */
    --danger: #FF69B4;            /* Neon Pink (distinct from primary red) */
    --warning: #FFA500;           /* Neon Orange */
    --light: #333333;            /* Dark Gray (Dark mode "light") */
    --dark: #000000;             /* Black */
    --gray: #A0A0A0;             /* Light Gray (Dark mode "gray") */
    --white: #1A1A1A;            /* Very Dark Gray (Dark mode "white" for card bgs) */

    /* UI Elements - Dark Neon */
    --bg-body: var(--dark);          /* Black Background */
    --bg-card: var(--white);         /* Very Dark Gray Card */
    --bg-header: var(--white);        /* Very Dark Gray Header */
    --bg-hover: rgba(255, 0, 0, 0.15); /* Neon Red hover */

    /* Text - Dark Neon */
    --text-main: #F5F5F5;        /* Very Light Gray/White Text */
    --text-muted: var(--gray);
    --text-heading: var(--primary);   /* Neon Red Headings */
    --text-on-primary: #FFFFFF;  /* White text on neon red */
    --text-on-dark: #F5F5F5;     /* Light text on black backgrounds */
    --text-link: var(--accent);  /* Neon Yellow links */
    --text-link-hover: #FFFACD;  /* Lighter Neon Yellow hover */

    /* Borders - Dark Neon */
    --border-color: #444444;     /* Dark Gray Border */
    --border-card: rgba(255, 0, 0, 0.4); /* Neon Red border */
    --border-header: rgba(255, 0, 0, 0.3); /* Lighter Neon Red border */

    /* Shadows - Dark Neon (subtle neon glow) */
    --shadow-card: 0 2px 10px rgba(255, 0, 0, 0.3);
    --shadow-card-hover: 0 5px 15px rgba(255, 0, 0, 0.4);

    /* Specific Elements - Dark Neon */
    --ticker-bg: #101010;         /* Very dark gray for ticker */
    --ticker-text: var(--text-main);      /* Light ticker text */
    --ticker-change-positive: var(--success); /* Neon Green */
    --ticker-change-negative: var(--danger);  /* Neon Pink for negative changes */

    /* Action Badges - Dark Theme (Neon) */
    --action-badge-buy-bg: rgba(0, 255, 0, 0.2); /* Neon Green bg */
    --action-badge-buy-text: var(--success);
    --action-badge-strong-buy-bg: rgba(0, 255, 0, 0.3);
    --action-badge-strong-buy-text: var(--success);
    --action-badge-sell-bg: rgba(255, 105, 180, 0.2); /* Neon Pink bg */
    --action-badge-sell-text: var(--danger);
    --action-badge-strong-sell-bg: rgba(255, 105, 180, 0.3);
    --action-badge-strong-sell-text: var(--danger);
    --action-badge-none-bg: rgba(160, 160, 160, 0.25); /* Gray bg */
    --action-badge-none-text: var(--gray);

    /* News Item Sentiment - Dark Theme (Neon) */
    --news-item-sentiment-positive-bg: rgba(0, 255, 0, 0.2);
    --news-item-sentiment-positive-text: var(--success);
    --news-item-sentiment-negative-bg: rgba(255, 105, 180, 0.2);
    --news-item-sentiment-negative-text: var(--danger);
    --news-item-sentiment-neutral-bg: rgba(160, 160, 160, 0.25);
    --news-item-sentiment-neutral-text: var(--gray);

    /* Price Change Indicators - Dark Theme (Neon) */
    --price-change-positive-bg: rgba(0, 255, 0, 0.25);
    --price-change-positive-text: #00CC00; /* Slightly Darker Neon Green */
    --price-change-negative-bg: rgba(255, 105, 180, 0.25);
    --price-change-negative-text: #FF4895; /* Slightly Darker Neon Pink */

    --theme-toggle-hover-bg: rgba(255, 0, 0, 0.2); /* Neon Red hover for toggle */
}

/* Theme Toggle Button */
.theme-toggle-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    margin-right: 0.5rem;
    border-radius: 50%;
    transition: background-color 0.3s;
}

.theme-toggle-btn:hover {
    background-color: var(--theme-toggle-hover-bg);
}

.theme-toggle-btn i {
    font-size: 1.1rem;
    transition: color 0.3s ease;
}

/* Set icon colors directly - Neon Theme */
.theme-light-icon {
    color: var(--warning); /* Neon Yellow sun */
}

.theme-dark-icon {
    color: #A0A0A0; /* Gray moon for light theme toggle */
}

[data-theme="dark"] .theme-light-icon {
    /* Sun icon in dark mode, could be a light color or accent */
    color: var(--accent); /* Neon Yellow sun in dark mode */
}
[data-theme="dark"] .theme-dark-icon {
    color: var(--secondary); /* Neon Orange/Red moon in dark mode */
}


body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Consider 'Orbitron' or 'Turret Road' for more neon feel */
    background-color: var(--bg-body); /* Use body background variable */
    color: var(--text-main);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* Navbar - Neon Adjustments */
.navbar {
    background-color: var(--primary); /* Neon Blue/Red */
    box-shadow: 0 2px 10px rgba(0,0,0,0.2); /* Slightly stronger shadow */
}
.navbar-brand {
    font-weight: 700;
    color: var(--text-on-primary) !important; /* Dark text on light neon, light on dark neon */
    text-shadow: 0 0 3px color-mix(in srgb, var(--accent) 30%, transparent); /* Subtle accent glow */
}
.navbar-brand span {
    color: var(--accent); /* Neon Accent */
}
.nav-link {
    /* For light theme: dark text. For dark theme: light text. */
    color: color-mix(in srgb, var(--text-on-primary) 80%, transparent) !important;
    transition: color 0.2s ease-in-out, text-shadow 0.2s ease-in-out;
}
.nav-link:hover, .nav-link.active {
    color: var(--text-on-primary) !important;
    text-shadow: 0 0 5px var(--accent); /* Stronger accent glow on hover */
}
.nav-link i {
    margin-right: 5px;
}
.navbar-toggler {
    border-color: color-mix(in srgb, var(--text-on-primary) 50%, transparent);
}
/* Adjust toggler icon based on text-on-primary for better contrast */
[data-theme="light"] .navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(26, 26, 26, 0.8)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}
[data-theme="dark"] .navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(245, 245, 245, 0.8)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

/* Ensure dropdown menu adapts - Neon */
.dropdown-menu {
    background-color: var(--bg-card); /* White/Very Dark Gray */
    border: 1px solid var(--border-card); /* Neon Accent Border */
    box-shadow: var(--shadow-card); /* Neon Shadow */
    border-radius: 8px; /* Slightly less rounded for a sharper neon look */
}
.dropdown-item {
    color: var(--text-main);
    transition: background-color 0.2s, color 0.2s, text-shadow 0.2s;
}
.dropdown-item:hover, .dropdown-item:focus {
    background-color: var(--bg-hover); /* Neon Accent Hover */
    color: var(--text-link-hover); /* Use link hover color */
    text-shadow: 0 0 3px var(--accent);
}
.dropdown-divider {
    border-top-color: var(--border-card); /* Neon Accent Border */
}
/* Dark mode specific dropdown adjustments */
[data-theme="dark"] .dropdown-menu {
    box-shadow: var(--shadow-card); /* Ensure dark neon shadow applies */
}
[data-theme="dark"] .dropdown-item:hover,
[data-theme="dark"] .dropdown-item:focus {
    background-color: var(--bg-hover); /* Ensure dark neon hover applies */
    color: var(--text-link-hover);
}

/* Cards - Neon Adjustments */
.card {
    border: 1px solid var(--border-card); /* Neon Border */
    border-radius: 10px;
    box-shadow: var(--shadow-card); /* Neon Shadow */
    margin-bottom: 24px;
    transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s, border-color 0.3s;
    background-color: var(--bg-card); /* White/Very Dark Gray */
    display: flex;
    flex-direction: column;
    color: var(--text-main); /* Dark/Light text */
}
.card:hover {
    transform: translateY(-5px) scale(1.01); /* Slight scale for neon pop */
    box-shadow: var(--shadow-card-hover); /* Neon Shadow Hover */
}
.card-header {
    font-weight: 600;
    background-color: var(--bg-header); /* White/Very Dark Gray */
    border-bottom: 1px solid var(--border-header); /* Neon Accent Border */
    padding: 16px 20px;
    border-radius: 10px 10px 0 0 !important;
    display: flex;
    align-items: center;
    color: var(--text-heading); /* Neon Primary */
    transition: background-color 0.3s, border-color 0.3s, color 0.3s, text-shadow 0.3s;
    text-shadow: 0 0 2px color-mix(in srgb, var(--text-heading) 30%, transparent);
}
.card-header i {
    margin-right: 10px;
    color: var(--secondary); /* Neon Secondary */
    filter: drop-shadow(0 0 2px var(--secondary)); /* Icon glow */
}
.card-body {
    padding: 20px;
    flex-grow: 1;
    transition: background-color 0.3s;
}
/* Target card bodies with p-0 separately */
.card-body.p-0 {
    padding: 0 !important;
}

/* Buttons - Neon Adjustments */
.btn {
     border-radius: 8px;
     padding: 8px 16px;
     font-weight: 600; /* Bolder for neon */
     transition: all 0.2s ease-in-out;
     text-transform: uppercase; /* Optional: for a more distinct style */
     letter-spacing: 0.5px; /* Optional */
     border-width: 1px; /* Ensure border is visible for outline buttons */
}
.btn-lg { padding: 12px 24px; font-size: 1.1rem;}
.btn-sm { padding: 5px 10px; font-size: 0.8rem;}

/* Neon Button Text Colors & Shadows */
.btn-primary { background-color: var(--primary); border-color: var(--primary); color: var(--text-on-primary); text-shadow: 0 0 3px rgba(0,0,0,0.3); }
.btn-primary:hover { background-color: color-mix(in srgb, var(--primary) 90%, var(--white) 10%); border-color: color-mix(in srgb, var(--primary) 90%, var(--white) 10%); color: var(--text-on-primary); box-shadow: 0 0 10px var(--primary); }
.btn-outline-primary { color: var(--primary); border-color: var(--primary); }
.btn-outline-primary:hover { background-color: var(--primary); color: var(--text-on-primary); box-shadow: 0 0 8px var(--primary); }

.btn-success { background-color: var(--success); border-color: var(--success); color: var(--dark); text-shadow: 0 0 3px rgba(0,0,0,0.2); } /* Dark text on neon green */
.btn-success:hover { background-color: color-mix(in srgb, var(--success) 90%, var(--white) 10%); border-color: color-mix(in srgb, var(--success) 90%, var(--white) 10%); color: var(--dark); box-shadow: 0 0 10px var(--success); }
.btn-outline-success { color: var(--success); border-color: var(--success); }
.btn-outline-success:hover { background-color: var(--success); color: var(--dark); box-shadow: 0 0 8px var(--success); }

.btn-danger { background-color: var(--danger); border-color: var(--danger); color: var(--white); text-shadow: 0 0 3px rgba(0,0,0,0.2); } /* White text on neon red/pink */
.btn-danger:hover { background-color: color-mix(in srgb, var(--danger) 90%, var(--white) 10%); border-color: color-mix(in srgb, var(--danger) 90%, var(--white) 10%); color: var(--white); box-shadow: 0 0 10px var(--danger); }
.btn-outline-danger { color: var(--danger); border-color: var(--danger); }
.btn-outline-danger:hover { background-color: var(--danger); color: var(--white); box-shadow: 0 0 8px var(--danger); }

.btn-info { background-color: var(--accent); border-color: var(--accent); color: var(--dark); text-shadow: 0 0 3px rgba(0,0,0,0.2); } /* Dark text on neon pink/yellow */
.btn-info:hover { background-color: color-mix(in srgb, var(--accent) 90%, var(--white) 10%); border-color: color-mix(in srgb, var(--accent) 90%, var(--white) 10%); color: var(--dark); box-shadow: 0 0 10px var(--accent); }
.btn-outline-info { color: var(--accent); border-color: var(--accent); }
.btn-outline-info:hover { background-color: var(--accent); color: var(--dark); box-shadow: 0 0 8px var(--accent); }

/* Warning button text color */
.btn-warning { background-color: var(--warning); border-color: var(--warning); color: var(--dark); text-shadow: 0 0 3px rgba(0,0,0,0.2); }
.btn-warning:hover { background-color: color-mix(in srgb, var(--warning) 90%, var(--white) 10%); border-color: color-mix(in srgb, var(--warning) 90%, var(--white) 10%); color: var(--dark); box-shadow: 0 0 10px var(--warning); }
.btn-outline-warning { color: var(--warning); border-color: var(--warning); }
.btn-outline-warning:hover { background-color: var(--warning); color: var(--dark); box-shadow: 0 0 8px var(--warning); }

[data-theme="dark"] .btn-success { color: var(--dark); } /* Ensure dark text on neon green in dark mode too */
[data-theme="dark"] .btn-success:hover { color: var(--dark); }
[data-theme="dark"] .btn-outline-success:hover { color: var(--dark); }
[data-theme="dark"] .btn-info { color: var(--dark); } /* Ensure dark text on neon yellow in dark mode */
[data-theme="dark"] .btn-info:hover { color: var(--dark); }
[data-theme="dark"] .btn-outline-info:hover { color: var(--dark); }
[data-theme="dark"] .btn-warning { color: var(--dark); } /* Dark text on neon orange in dark mode */
[data-theme="dark"] .btn-warning:hover { color: var(--dark); }
[data-theme="dark"] .btn-outline-warning:hover { color: var(--dark); }


.btn-dark { background-color: var(--dark); border-color: var(--dark); color: var(--text-on-dark); } /* Black button, light text */
.btn-dark:hover { background-color: color-mix(in srgb, var(--dark) 85%, #555 15%); border-color: color-mix(in srgb, var(--dark) 85%, #555 15%); color: var(--text-on-dark); box-shadow: 0 0 8px var(--gray); }

.btn-light { background-color: var(--light); border-color: var(--border-color); color: var(--text-main); } /* White/Light Gray button, dark text */
.btn-light:hover { background-color: color-mix(in srgb, var(--light) 90%, black); border-color: color-mix(in srgb, var(--border-color) 90%, black); box-shadow: 0 0 8px var(--gray); }
.btn-outline-light { color: var(--light); border-color: var(--light); }
.btn-outline-light:hover { background-color: var(--light); color: var(--primary); }


.btn-link { color: var(--text-link); text-decoration: none; font-weight: 600; text-transform: none; }
.btn-link:hover { color: var(--text-link-hover); text-decoration: underline; text-shadow: 0 0 3px var(--text-link-hover); }


/* Forms - Neon Adjustments */
.form-control {
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid var(--border-color); /* Neon Accent Border */
    background-color: var(--bg-card); /* White/Very Dark Gray */
    color: var(--text-main);
    transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s, color 0.3s;
}
.form-control::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
}
.form-control:focus {
    border-color: var(--primary); /* Neon Primary Border */
    box-shadow: 0 0 0 0.2rem color-mix(in srgb, var(--primary) 30%, transparent), 0 0 8px color-mix(in srgb, var(--primary) 50%, transparent); /* Neon Glow Focus Ring */
    background-color: var(--bg-card);
    color: var(--text-main);
}
.form-label { font-weight: 500; margin-bottom: 5px; color: var(--text-muted); text-transform: uppercase; font-size: 0.8em; letter-spacing: 0.5px;}
.input-group-text {
    background-color: color-mix(in srgb, var(--bg-body) 80%, var(--border-color) 20%);
    border: 1px solid var(--border-color); /* Neon Accent Border */
    color: var(--text-muted);
}

/* Improve form controls in dark mode - Neon */
[data-theme="dark"] .form-control {
    background-color: color-mix(in srgb, var(--bg-card) 95%, black 5%);
    border-color: var(--border-card); /* Dark Neon Border */
    color: var(--text-main);
}

[data-theme="dark"] .form-control:focus {
    background-color: color-mix(in srgb, var(--bg-card) 90%, black 10%);
    border-color: var(--primary); /* Dark Neon Primary Border */
    color: var(--text-main);
    box-shadow: 0 0 0 0.2rem color-mix(in srgb, var(--primary) 30%, transparent), 0 0 8px color-mix(in srgb, var(--primary) 50%, transparent);
}

[data-theme="dark"] .form-control::placeholder {
    color: var(--text-muted);
    opacity: 0.8;
}

[data-theme="dark"] .form-text {
    color: var(--text-muted) !important;
}

[data-theme="dark"] .input-group-text {
    background-color: color-mix(in srgb, var(--bg-header) 95%, var(--primary) 5%);
    color: var(--text-heading);
    border-color: var(--border-card); /* Dark Neon Border */
}

/* Tables - Neon Adjustments */
.table {
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
    color: var(--text-main);
    transition: color 0.3s, background-color 0.3s, border-color 0.3s;
    background-color: transparent; /* Ensure table itself isn't overriding */
}
.table thead th {
    border-bottom: 2px solid var(--border-color);
    background-color: var(--bg-header);
    color: var(--text-muted);
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.8rem;
    letter-spacing: 0.5px;
    white-space: nowrap;
    vertical-align: middle;
    padding: 12px 15px;
    transition: background-color 0.3s, border-color 0.3s, color 0.3s;
}
.table tbody tr {
    border-bottom: 1px solid var(--border-color);
    transition: background-color 0.2s, border-color 0.2s, color 0.2s;
    vertical-align: middle;
}
.table tbody tr:last-child { border-bottom: none; }
.table tbody tr:hover { background-color: var(--bg-hover); }
.table td { padding: 12px 15px; }

/* Badges */
.badge { padding: 6px 10px; font-weight: 500; font-size: 0.85rem; border-radius: 15px; }
/* Ensure text color contrasts with background */
.badge.bg-success, .badge.bg-danger, .badge.bg-info, .badge.bg-primary { color: #fff; }
.badge.bg-warning { color: #444; }
.badge.bg-light { color: var(--text-main); }
.badge.bg-dark { color: var(--text-on-dark); }
.badge.bg-secondary { color: var(--text-on-primary); } /* Assuming secondary is dark enough */
[data-theme="dark"] .badge.bg-warning { color: #1a202c; } /* Dark text on warning in dark mode */
[data-theme="dark"] .badge.bg-secondary { color: #e2e8f0; } /* Light text on secondary in dark mode */
[data-theme="dark"] .badge.bg-light { color: var(--text-main); } /* Light text on "light" (dark gray) bg */

/* List Groups */
.list-group-item {
    border: none; /* Remove default borders */
    border-bottom: 1px solid var(--border-color);
    padding: 16px 20px;
    transition: background-color 0.2s, border-color 0.2s, color 0.2s;
    background-color: transparent; /* Use card bg */
    color: var(--text-main);
}
.list-group-item:last-child { border-bottom: none; }
.list-group-flush .list-group-item { border-width: 0 0 1px; }
.list-group-flush:last-child .list-group-item:last-child { border-width: 0; }
.list-group-item:hover { background-color: var(--bg-hover); }
.list-group-item strong { color: var(--primary); }
.list-group-item a { color: var(--text-link); }
.list-group-item a:hover { color: var(--text-link-hover); }

/* Ensure background is correct */
.list-group {
    background-color: var(--bg-card);
}
.card > .list-group:last-child .list-group-item:last-child {
    border-bottom-right-radius: var(--bs-card-inner-border-radius); /* Check if Bootstrap var is available or use hardcoded */
    border-bottom-left-radius: var(--bs-card-inner-border-radius); /* Check if Bootstrap var is available or use hardcoded */
    /* Fallback */
    border-bottom-right-radius: calc(10px - 1px);
    border-bottom-left-radius: calc(10px - 1px);
}

/* Action Badge Specific Styles */
.action-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: capitalize;
    display: inline-block;
    min-width: 80px;
    text-align: center;
}
.action-badge.buy { background-color: var(--action-badge-buy-bg); color: var(--action-badge-buy-text); }
.action-badge.strong_buy { background-color: var(--action-badge-strong-buy-bg); color: var(--action-badge-strong-buy-text); }
.action-badge.sell { background-color: var(--action-badge-sell-bg); color: var(--action-badge-sell-text); }
.action-badge.strong_sell { background-color: var(--action-badge-strong-sell-bg); color: var(--action-badge-strong-sell-text); }
.action-badge.none { background-color: var(--action-badge-none-bg); color: var(--action-badge-none-text); }

/* Dashboard Specific */
.welcome-card {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: var(--text-on-primary);
    border-radius: 10px;
    padding: 30px;
    margin-bottom: 30px;
}
.welcome-card h2 { font-weight: 700; margin-bottom: 10px; }
.welcome-card p { opacity: 0.9; margin-bottom: 0; }
[data-theme="dark"] .welcome-card {
     background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); /* Darker gradient */
}

.ticker-container {
    background-color: var(--ticker-bg);
    color: var(--ticker-text);
    padding: 10px 0;
    overflow: hidden;
    white-space: nowrap;
    margin-bottom: 24px;
    border-radius: 5px;
}
.ticker-tape { display: inline-block; animation: ticker 60s linear infinite; padding-left: 100%; }
.ticker-item { display: inline-block; padding: 0 25px; }
.ticker-symbol { font-weight: 600; margin-right: 8px; opacity: 0.8; }
.ticker-price { margin-right: 8px; }
.ticker-change { font-size: 0.9em; }
.ticker-change.positive { color: var(--ticker-change-positive); }
.ticker-change.negative { color: var(--ticker-change-negative); }
@keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

.stats-card { text-align: center; padding: 20px; height: 100%; }
.stats-card i { font-size: 2.2rem; color: var(--secondary); margin-bottom: 15px; display: block; }
.stats-card h3 { font-size: 1.8rem; font-weight: 700; margin-bottom: 5px; color: var(--text-heading); }
.stats-card p { color: var(--text-muted); margin-bottom: 0; font-size: 0.9rem; }

/* Analysis Page Specific */
.stock-header {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: var(--text-on-primary);
    border-radius: 10px; padding: 30px; margin-bottom: 30px;
    position: relative; overflow: hidden;
}
.stock-header::after { /* Subtle pattern for dark mode */
    content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
    background-size: 10px 10px;
    opacity: 0.03;
    z-index: 0;
    display: none; /* Hide by default */
}
[data-theme="dark"] .stock-header {
    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); /* Darker gradient */
}
[data-theme="dark"] .stock-header::after {
    display: block; /* Show pattern only in dark mode */
}
.stock-header .row { position: relative; z-index: 1; }
.stock-header h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 5px; }
.stock-header .company-name { font-size: 1rem; opacity: 0.8; margin-bottom: 15px; }
.price-large { font-size: 2.8rem; font-weight: 700; margin-bottom: 5px; }
.price-change {
    font-size: 1.1rem; margin-bottom: 0; display: inline-block;
    padding: 5px 12px; border-radius: 20px;
    background-color: var(--price-change-positive-bg); /* Default to positive */
    color: var(--price-change-positive-text);
}
.price-change.negative {
    background-color: var(--price-change-negative-bg);
    color: var(--price-change-negative-text);
}


.metric-card { padding: 15px; border-radius: 10px; margin-bottom: 20px; display: flex; align-items: center; }
.metric-card .icon { font-size: 1.6rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; border-radius: 50%; margin-right: 15px; color: white; flex-shrink: 0; }
.metric-card .content h3 { font-size: 1.2rem; font-weight: 700; margin-bottom: 0; color: var(--text-heading); } /* Adjusted color */
.metric-card .content p { margin-bottom: 0; color: var(--text-muted); font-size: 0.9rem; }
/* Backgrounds adjusted for subtlety */
.metric-positive { background-color: color-mix(in srgb, var(--success) 5%, transparent); } .metric-positive .icon { background-color: var(--success); }
.metric-negative { background-color: color-mix(in srgb, var(--danger) 5%, transparent); } .metric-negative .icon { background-color: var(--danger); }
.metric-neutral { background-color: color-mix(in srgb, var(--gray) 5%, transparent); } .metric-neutral .icon { background-color: var(--gray); }
.metric-warning { background-color: color-mix(in srgb, var(--warning) 5%, transparent); } .metric-warning .icon { background-color: var(--warning); color: #444 } /* Dark text for warning icon */
[data-theme="dark"] .metric-warning .icon { color: #1a202c; } /* Dark text for warning icon */


.action-btn-group { display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap; }
.action-btn { flex: 1 1 auto; min-width: 120px; font-weight: 600; padding: 12px 10px; border-radius: 10px; text-align: center; transition: all 0.3s; border: 2px solid transparent; }
.action-btn i { display: block; margin-bottom: 5px; font-size: 1.3rem; }
.action-btn small { font-size: 0.8em; color: var(--text-muted); } /* Use variable */
.action-btn:hover { transform: translateY(-3px); }
.action-btn.active { border-color: var(--primary); box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 30%, transparent); } /* Add subtle glow */
.action-btn.set-action.btn-success.active { border-color: var(--success); box-shadow: 0 0 0 2px color-mix(in srgb, var(--success) 30%, transparent); }
.action-btn.set-action.btn-primary.active { border-color: var(--primary); box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 30%, transparent);}
.action-btn.set-action.btn-danger.active { border-color: var(--danger); box-shadow: 0 0 0 2px color-mix(in srgb, var(--danger) 30%, transparent);}
.action-btn.set-action.btn-dark.active { border-color: var(--dark); box-shadow: 0 0 0 2px color-mix(in srgb, var(--dark) 30%, transparent);}

.target-price { display: flex; align-items: center; justify-content: center; color: white; border-radius: 10px; padding: 15px 20px; margin-bottom: 20px; text-align: center; }
.target-price.positive { background: linear-gradient(135deg, var(--success) 0%, color-mix(in srgb, var(--success) 80%, black) 100%); }
.target-price.negative { background: linear-gradient(135deg, var(--danger) 0%, color-mix(in srgb, var(--danger) 80%, black) 100%); }
.target-price .price { font-size: 1.8rem; font-weight: 700; margin-right: 15px; flex-shrink: 0; }
.target-price .change { font-size: 1.1rem; text-align: left; }
.target-price .change small { font-size: 0.85rem; display: block; opacity: 0.8; }

.prediction-chart { width: 100%; height: auto; min-height: 300px; background-color: var(--bg-card); border-radius: 10px; overflow: hidden; margin-bottom: 20px; }
.prediction-chart img { display: block; max-width: 100%; height: auto; border-radius: 10px; }
/* Placeholder styling */
.prediction-chart.bg-light { background-color: var(--bg-hover) !important; }
.prediction-chart .text-muted { color: var(--text-muted) !important; }

/* News items */
.ticker-news { background-color: var(--bg-card); border-radius: 10px; padding: 0; margin-bottom: 20px; overflow: hidden; }
.news-item { padding: 15px 20px; border-bottom: 1px solid var(--border-color); }
.news-item:last-child { border-bottom: none; }
.news-item .title { font-weight: 600; margin-bottom: 5px; color: var(--text-main); text-decoration: none; display: block; }
.news-item .title:hover { color: var(--text-link-hover); }
.news-item .source { font-size: 0.85rem; color: var(--text-muted); margin-right: 10px; }
.news-item .date { font-size: 0.85rem; color: var(--text-muted); }
.news-item .sentiment { display: inline-block; padding: 3px 8px; border-radius: 15px; font-size: 0.75rem; font-weight: 600; margin-left: 10px; text-transform: capitalize; }
.news-item .sentiment.positive { background-color: var(--news-item-sentiment-positive-bg); color: var(--news-item-sentiment-positive-text); }
.news-item .sentiment.negative { background-color: var(--news-item-sentiment-negative-bg); color: var(--news-item-sentiment-negative-text); }
.news-item .sentiment.neutral { background-color: var(--news-item-sentiment-neutral-bg); color: var(--news-item-sentiment-neutral-text); }


/* Auth Pages Specific */
.auth-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-grow: 1;
    padding: 40px 20px;
}
.auth-wrapper .card { max-width: 450px; width: 100%;}
.auth-wrapper .card-body { padding: 35px 40px; }
.auth-wrapper .card-header i { font-size: 1.2rem; color: var(--secondary); } /* Ensure icon color adapts */
.auth-wrapper .btn-primary { padding: 12px 20px; font-weight: 600; font-size: 1rem; }
.auth-wrapper .text-center span { color: var(--text-muted); margin-right: 5px;}


/* Footer */
.main-content { flex-grow: 1; }
.footer {
    background-color: var(--primary);
    color: rgba(255, 255, 255, 0.8);
    padding: 40px 0 20px;
    margin-top: auto;
}
[data-theme="dark"] .footer {
    background-color: #171923; /* Darker footer background */
    color: #a0aec0; /* Lighter text */
}
.footer h5 { color: var(--text-on-primary); font-weight: 600; margin-bottom: 20px; }
[data-theme="dark"] .footer h5 { color: #e2e8f0; }
.footer a { color: var(--accent); text-decoration: none; transition: color 0.2s ease-in-out; }
.footer a:hover { text-decoration: underline; color: var(--text-on-primary); }
[data-theme="dark"] .footer a:hover { color: #ffffff; }
.footer p { margin-bottom: 10px; line-height: 1.6; }
.footer .list-unstyled li { margin-bottom: 10px; }
.footer .small { color: rgba(255, 255, 255, 0.6); font-size: 0.85rem; }
[data-theme="dark"] .footer .small { color: #718096; }
.footer .footer-bottom {
     margin-top: 30px;
     padding-top: 20px;
     border-top: 1px solid rgba(255, 255, 255, 0.2);
}
[data-theme="dark"] .footer .footer-bottom {
    border-top-color: #4a5568;
}

/* Utilities */
/* Re-define text colors using variables for theme adaptability */
.text-success { color: var(--success) !important; }
.text-danger { color: var(--danger) !important; }
.text-warning { color: var(--warning) !important; }
.text-info { color: var(--accent) !important; }
.text-muted { color: var(--text-muted) !important; } /* Ensure this uses the theme variable */

.bg-success { background-color: var(--success) !important; }
.bg-danger { background-color: var(--danger) !important; }
.bg-warning { background-color: var(--warning) !important; }
.bg-info { background-color: var(--accent) !important; }
.bg-light { background-color: var(--light) !important; } /* Will be dark gray in dark mode */
.bg-dark { background-color: var(--dark) !important; }
.bg-secondary { background-color: var(--secondary) !important; }

/* Toast Styling */
#toast-container .toast { border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);}
#toast-container .toast-header { border-bottom: none; background-color: rgba(0,0,0,0.1); color: inherit;}
#toast-container .toast-body { display: flex; align-items: center; }
#toast-container .toast-body i { margin-right: 10px; font-size: 1.2rem; }
/* Ensure toast colors adapt */
#toast-container .bg-success { background-color: var(--success) !important; color: var(--dark) !important; }
#toast-container .bg-success i { color: var(--dark) !important; }
#toast-container .bg-danger { background-color: var(--danger) !important; color: var(--white) !important; } /* Assuming white text is desired */
#toast-container .bg-danger i { color: var(--white) !important; }
#toast-container .bg-warning { background-color: var(--warning) !important; color: var(--dark) !important; }
#toast-container .bg-warning i { color: var(--dark) !important; }
#toast-container .bg-info { background-color: var(--accent) !important; color: var(--dark) !important; }
#toast-container .bg-info i { color: var(--dark) !important; }

/* Dark theme overrides for toast text if needed, but base is light text on dark bg */
[data-theme="dark"] #toast-container .bg-success { color: var(--dark) !important; } /* Neon green is bright, dark text still better */
[data-theme="dark"] #toast-container .bg-success i { color: var(--dark) !important; }
[data-theme="dark"] #toast-container .bg-danger { color: var(--white) !important; } /* Neon pink is bright, white text okay */
[data-theme="dark"] #toast-container .bg-danger i { color: var(--white) !important; }
[data-theme="dark"] #toast-container .bg-warning { color: var(--dark) !important; } /* Neon orange, dark text */
[data-theme="dark"] #toast-container .bg-warning i { color: var(--dark) !important; }
[data-theme="dark"] #toast-container .bg-info { color: var(--white) !important; } /* Neon yellow accent, white text */
[data-theme="dark"] #toast-container .bg-info i { color: var(--white) !important; }


[data-theme="dark"] #toast-container .toast {
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    color: #fff !important; /* Default white text for dark theme toasts */
    background-clip: padding-box; /* Fix potential border issues */
}
[data-theme="dark"] #toast-container .toast-header {
    background-color: rgba(255, 255, 255, 0.1);
    color: #e2e8f0; /* Light header text */
}
[data-theme="dark"] #toast-container .btn-close-white { filter: invert(1) grayscale(100%) brightness(200%); }


/* News page loading spinner */
#loading-spinner {
    color: var(--primary) !important;
}

/* Modal Styling */
.modal-content {
    border-radius: 10px;
    border: 1px solid var(--border-card);
    background-color: var(--bg-card);
    color: var(--text-main);
}
.modal-header {
    background-color: var(--bg-header);
    border-bottom: 1px solid var(--border-header);
    border-radius: 10px 10px 0 0;
    color: var(--text-heading);
}
.modal-title { color: var(--text-heading); font-weight: 600; }
.modal-body { padding: 20px; }
.modal-footer {
    background-color: var(--bg-header);
    border-top: 1px solid var(--border-header);
}
.btn-close { filter: invert(0.5) sepia(1) saturate(20) hue-rotate(190deg) brightness(1.2); }
[data-theme="dark"] .btn-close { filter: invert(1) grayscale(100%) brightness(200%); }

/* ----- Explicit Dark Theme Overrides (To help ensure application) ----- */
[data-theme="dark"] .card {
    background-color: var(--bg-card);   /* Re-apply dark card background */
    color: var(--text-main);           /* Re-apply light text color */
    border-color: var(--border-card);  /* Re-apply dark border color */
    box-shadow: var(--shadow-card);    /* Apply proper shadow */
    transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s, border-color 0.3s, color 0.3s;
}

[data-theme="dark"] .card:hover {
    box-shadow: var(--shadow-card-hover); /* Apply hover shadow explicitly */
}

[data-theme="dark"] .card-header {
    background-color: color-mix(in srgb, var(--bg-header) 93%, var(--primary) 7%); /* Enhanced primary tint */
    color: var(--text-heading);        /* Re-apply light heading color */
    border-bottom-color: var(--border-header); /* Re-apply dark border */
}

[data-theme="dark"] .card-header i {
    color: var(--secondary); /* Ensure icon color is correct in dark mode */
}

[data-theme="dark"] .card-body {
    color: var(--text-main); /* Ensure body text inherits correctly */
    background-color: var(--bg-card); /* Explicitly set the background */
}

/* Special treatment for Quick Stock Analysis card */
[data-theme="dark"] .card.quick-stock-analysis-card {
    background-color: color-mix(in srgb, var(--bg-card) 95%, var(--secondary) 5%); /* Subtle highlight */
    border-color: color-mix(in srgb, var(--border-card) 80%, var(--secondary) 20%); /* Tinted border */
}

[data-theme="dark"] .card.quick-stock-analysis-card .card-header {
    background-color: color-mix(in srgb, var(--bg-header) 90%, var(--secondary) 10%); /* More noticeable header */
    border-bottom-color: color-mix(in srgb, var(--border-header) 80%, var(--secondary) 20%);
}

[data-theme="dark"] .card.quick-stock-analysis-card .card-header i {
    color: var(--secondary); /* Brighter icon */
}

/* Special treatment for Analysis History card */
/* Ensure you ADD class="analysis-history-card" to the div in index.html if you want these */
[data-theme="dark"] .card.analysis-history-card {
    background-color: color-mix(in srgb, var(--bg-card) 97%, var(--primary) 3%); /* Subtle primary tint */
    border-color: color-mix(in srgb, var(--border-card) 85%, var(--primary) 15%); /* Tinted border */
    box-shadow: 0 4px 16px rgba(0,0,0,0.3); /* Enhanced shadow */
}

[data-theme="dark"] .card.analysis-history-card .card-header {
    background-color: color-mix(in srgb, var(--bg-header) 90%, var(--primary) 10%); /* More visible header */
    border-bottom-color: color-mix(in srgb, var(--border-header) 80%, var(--primary) 20%);
    color: #e6f0ff; /* Brighter text */
}

[data-theme="dark"] .card.analysis-history-card .card-header i {
    color: var(--primary); /* Matching icon color */
}


/* ===== START: Stronger Table Overrides for Dark Mode ===== */

/* Ensure table within card adapts */
[data-theme="dark"] .card .table {
    color: var(--text-main);
    background-color: transparent; /* Make table background transparent */
    border-color: var(--border-color); /* Use theme border color */
}

[data-theme="dark"] .card .table thead th {
    background-color: color-mix(in srgb, var(--bg-card) 85%, var(--primary) 15%); /* Darker header, primary tint */
    color: #edf2f7; /* Slightly less bright than main text for subtle hierarchy */
    border-bottom: 2px solid rgba(255, 255, 255, 0.15) !important; /* Stronger border */
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

[data-theme="dark"] .card .table tbody tr {
    background-color: transparent !important; /* Force transparent background for rows */
    color: var(--text-main) !important; /* Force light text */
    border-bottom-color: rgba(255, 255, 255, 0.1); /* More visible row borders */
}

/* Explicitly style table cells */
[data-theme="dark"] .card .table td {
     color: var(--text-main) !important; /* Ensure cell text is light */
     background-color: transparent !important; /* Force transparent background */
     border-top: 1px solid var(--border-color); /* Use border-top for td as tr border might be overridden */
     vertical-align: middle; /* Ensure vertical alignment */
}

/* Ensure first row cells don't have double border */
[data-theme="dark"] .card .table tbody tr:first-child td {
    border-top: none;
}


/* Apply subtle striping to rows using TD background */
[data-theme="dark"] .card .table tbody tr:nth-child(odd) td {
     background-color: rgba(255, 255, 255, 0.03) !important;
}

/* Apply hover effect to TDs */
[data-theme="dark"] .card .table tbody tr:hover td {
     background-color: rgba(255, 255, 255, 0.07) !important;
}

/* Override Bootstrap's default hover color specifically */
[data-theme="dark"] .table-hover > tbody > tr:hover > * {
    --bs-table-accent-bg: rgba(255, 255, 255, 0.07); /* Match TD hover */
    color: var(--text-main); /* Ensure text color stays light */
}

/* Ensure links and specific text colors within the table cells also adapt */
[data-theme="dark"] .card .table td a { color: var(--accent); }
[data-theme="dark"] .card .table td a:hover { color: #76e4d9; }
[data-theme="dark"] .card .table td .text-primary { color: #63b3ed !important; }
[data-theme="dark"] .card .table td .text-success { color: #68d391 !important; }
[data-theme="dark"] .card .table td .text-danger { color: #fc8181 !important; }
[data-theme="dark"] .card .table td .text-muted { color: var(--text-muted) !important; }

/* Action Badges within table cells */
[data-theme="dark"] .card .table .action-badge {
    /* Styles already defined elsewhere, just ensure they apply */
}

/* ===== END: Stronger Table Overrides for Dark Mode ===== */


/* Ensure placeholder text color adapts */
[data-theme="dark"] .text-muted,
[data-theme="dark"] .form-text {
    color: var(--text-muted) !important; /* Use important to override potential Bootstrap specificity */
}

/* Ensure link colors in dark mode have good contrast */
[data-theme="dark"] a {
    color: var(--text-link);
    transition: color 0.2s;
}

[data-theme="dark"] a:hover {
    color: var(--text-link-hover);
}


/* Responsive Adjustments */
@media (max-width: 767.98px) {
    .stats-card h3 { font-size: 1.5rem; }
    .stats-card i { font-size: 1.8rem; }
    .welcome-card { text-align: center; }
    .welcome-card .text-md-end { text-align: center !important; margin-top: 15px; }
    .ticker-tape { animation-duration: 30s; }
    .action-btn-group { flex-direction: column; }
    .auth-wrapper .card-body { padding: 25px 20px; }
    .stock-header { text-align: center; padding: 20px; }
    .stock-header h1 { font-size: 2rem; }
    .price-large { font-size: 2.2rem; }
    .stock-header .text-lg-end { text-align: center !important; }

    /* Ensure table doesn't break layout on small screens */
    .table-responsive {
        border: none; /* Remove border if needed */
    }
}

/* Fix button group alignment in tables */
.table .btn-group, .table .btn-group-sm {
    display: flex;
    align-items: stretch;
}

.table .btn-group .btn, .table .btn-group-sm .btn {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    border-radius: 0;
}

.table .btn-group .btn:first-child, .table .btn-group-sm .btn:first-child {
    border-top-left-radius: 0.375rem;
    border-bottom-left-radius: 0.375rem;
}

.table .btn-group .btn:last-child, .table .btn-group-sm .btn:last-child {
    border-top-right-radius: 0.375rem;
    border-bottom-right-radius: 0.375rem;
}